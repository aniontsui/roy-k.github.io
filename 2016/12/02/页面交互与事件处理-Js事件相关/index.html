
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>事件相关 | 读书笔记</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="Roy-K">
    
    <meta name="description" content="事件相关Window事件onload               页面加载完毕的事件
onscroll            页面滚动时候触发的事件
onresize            页面大小改变的时候时候触发的事件
DOM Ready    在页面的DOM树创建完成后(也就是HTML解析第一">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/myLogo.png">
    <link rel="apple-touch-icon-precomposed" href="/img/myLogo.png">
    

  
  

    <link rel="stylesheet" href="/css/style.css">
    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?d182ed77fc48758bf45a33835ee35745";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

      <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

  _st('install','.............Add your swiftype userID...............');
</script>
</head>

  <body>
    <header>
      <div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="读书笔记">读书笔记</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
                    <ul>
					 
						<li><a href="https://roy-k.github.io/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					</li>
                <!--<li><div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div></li>-->

				</ul>
			</nav>	
</div>
    </header>
    <div id="container" class="clearfix">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/12/02/页面交互与事件处理-Js事件相关/" title="事件相关" itemprop="url">事件相关</a>
  </h1>
  <p class="article-time">
    <time datetime="2016-12-02T13:46:25.000Z" itemprop="datePublished">2016年 12月 2日</time>
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title"></strong>
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#事件相关"><span class="toc-number">1.</span> <span class="toc-text">事件相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Window事件"><span class="toc-number">1.0.1.</span> <span class="toc-text">Window事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他事件"><span class="toc-number">1.0.2.</span> <span class="toc-text">其他事件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#事件"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#注册事件方式"><span class="toc-number">1.0.2.2.</span> <span class="toc-text">注册事件方式</span></a></li></ol></li></ol></li></ol></li></ol>
		</div>
		
		<h1 id="事件相关"><a href="#事件相关" class="headerlink" title="事件相关"></a>事件相关</h1><h3 id="Window事件"><a href="#Window事件" class="headerlink" title="Window事件"></a>Window事件</h3><pre><code>onload               页面加载完毕的事件
onscroll            页面滚动时候触发的事件
onresize            页面大小改变的时候时候触发的事件
</code></pre><p><strong>DOM Ready</strong><br>    在页面的DOM树创建完成后(也就是HTML解析第一步完成)即触发,而无需等待其他资源的加载.</p>
<pre><code>浏览器渲染引擎的基本渲染流程:

    1. 解析HTML,构建DOM树(构建DOM节点);
    2. 构建渲染树(解析样式信息);
    3. 布局渲染树(布局DOM节点);        
    4. 绘制渲染树(绘制DOM节点);

DOMContentLoaded
    - 支持DOMContentLoaded事件的, 就用该事件
    - 不支持的, 就用著名的Hack兼容方式, 原理通过IE中的document.documentElement.doScroll(&quot;left&quot;)来判断DOM数是否创建完毕
    - 摘自DOM事件探秘-慕课网
</code></pre><h3 id="其他事件"><a href="#其他事件" class="headerlink" title="其他事件"></a>其他事件</h3><pre><code>onclick                鼠标的单击事件
ondblclick            鼠标的双击事件
onmouseup            鼠标的弹起事件

onmouseover            鼠标移入的事件
onmousemove            鼠标移动的事件
onmouseout            鼠标移出的事件

onkeydown            键盘上的按键按下的时候就会触发                一般输入框和文本框使用
onkeyup                键盘上的按键按下,并抬起来的时候才会触发        一般输入框和文本框使用

onfocus                获得焦点的事件
onblur                失去焦点的事件
</code></pre><h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h4><pre><code>1. 事件源         x盒子
2. 事件             点击
3. 事件处理程序     关闭广告

事件源.事件 = function() {事件处理函数}

书写事件位置:

1. 行内    标签里面
2. 内嵌    script里面    函数调用等
</code></pre><h4 id="注册事件方式"><a href="#注册事件方式" class="headerlink" title="注册事件方式"></a>注册事件方式</h4><p><strong>On</strong>的方式只能对同一标签对象注册一个事件，如果注册多个，后面的会覆盖前面的事件，<br>如果想对某个标签对象注册多个事件的话，可以用<strong>addEventListener</strong></p>
<p>obj.addEventListener(type,listener,false); false为支持冒泡;</p>
<pre><code>但是IE8及之前的浏览器仅支持attachEvent
</code></pre><p>obj.attachEvent(“on”+type,listener); 需加”on”;</p>
<pre><code>/**
 * 封装了兼容版本的注册事件的方法
 * @param element
 * @param type
 * @param listener
 */
function addEventLister(element,type,listener){
    // 能力检测
    if(element.addEventListener){
        element.addEventListener(type,listener,false);

    }else if(element.attachEvent){
        element.attachEvent(&quot;on&quot;+type,listener);

    }else {
        element[&quot;on&quot;+type] = listener;
    }
}
</code></pre><p><strong>事件冒泡</strong></p>
<pre><code>当一个元素上的事件被触发的时候，比如说鼠标点击了一个按钮，同样的事件将会在那个元素的所有祖先元素中被触发。
这一过程被称为事件冒泡；这个事件从原始元素开始一直冒泡到DOM树的最上层。

事件委托:
应用:本来该自己做的事情,我们可以让另一个对象(父级对象)帮我们做.
    比如:在点击任何子元素,都要触发同样事件的情况下,就可以给父级设置事件!    

E 6.0: 
div -&gt; body -&gt; html -&gt; document
其他浏览器: 
div -&gt; body -&gt; html -&gt; document -&gt; window

以下事件不冒泡：blur、focus、load、unload

阻止冒泡的方法
    w3c的方法是event.stopPropagation() 
    IE则是使用event.cancelBubble = true 
    兼容:
        if(event &amp;&amp; event.stopPropagation) {         
          event.stopPropagation();  //  w3c 标准
          } else {
          event.cancelBubble = true;  // ie 678  ie浏览器
        }
</code></pre><p><strong>事件对象 (event)</strong></p>
<pre><code>    src.onclick = function(event) {}
    在触发事件的时候, 会产生一个事件对象event, 这个对象中包含着所有与事件相关的信息. 所有浏览器都支持event对象, 但方式不同.

    IE8以下问题：
    1. attach回调函数this指向window，可以通过event获得事件对象
    2. on添加事件时，回调中this指向undefined；需通过window.event获得

    比如鼠标操作的时候, 会添加鼠标位置的相关信息到event中.

    兼容处理:var event = event || window.event;
</code></pre><p><strong>event 常见属性</strong></p>
<pre><code>    - 属性        作用

    - clientX    光标相对与可视区域基准点(固定定位)的位置    
    - clientY    光标相对与可视区域基准点(固定定位)的位置    

    - data    返回拖拽对象的URL字符串（dragDrop）
    - width    该窗口或框架的高度
    - height    该窗口或框架的高度

    - pageX    光标相对与文档基准点(绝对定位)的位置（ie无）
    - pageY    光标相对与文档基准点(绝对定位)的位置（ie无）
        兼容:
        - var pageX = event.pageX || event.clientX + document.documentElement.scrollLeft;
        - var pageY = event.pageY || event.clientY+document.documentElement.scrollTop;

    - screenX    光标相对于该屏幕的水平位置
    - screenY    光标相对于该屏幕的垂直位置

    - target    该事件被传送到的对象
        - target = event.target || event.srcElement;
        - 兼容性: targetId=event.target ? event.target.id : event.srcElement.id;

    - currentTarget 当前执行阶段的对象
    - eventPhase        判断当前对象处于哪个执行阶段    

    - type    事件的类型 click/move/over等
    - preventDefault        阻止默认行为 IE: event.returnValue = false;
</code></pre><p><strong>防止拖动选择</strong></p>
<pre><code>正常时按下鼠标然后拖拽可以选择文字的。 
解决方式:清除选中的内容 
window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();
</code></pre><p><strong>计时器</strong></p>
<pre><code>Js是单线程执行的,某一段代码执行的时候,所有后续的任务必须等待,形成一个队列,常称为&quot;阻塞式执行&quot;.
计时器是在合适的时间将代码插入队列,但不保证执行.

var that = this; 经常用到

setTimeout(function,delay); 返回数字
    延迟执行,

setInterval(function,delay);
    循环执行,

clearTimeout(num);
clearInterval(num);

seInterval是排队执行的

    假如 间隔时间是1秒, 而执行的程序时间是2秒 上次没有执行完的代码会排队,上一次执行完下一次就立即执行,这样实际执行间隔时间为2秒.

setTimeout 延迟时间为1秒执行,要执行的代码需要2秒来执行,那这段代码上一次与下一次的执行时间为3秒.

定时器特殊:
    setTimeout(goIndexPage,1000);
    var count = 5;
    demo.innerHTML = &quot;&lt;a href=&#39;http://www..&#39;&gt;本页面将在&quot;+count+&quot;秒钟之后跳转页面&lt;/a&gt;&quot;;

    递归方式避免setInterval的时间混乱
    function goIndexPage() {
        count--;
        if(count&lt;=0) {
            window.location.href=&quot;&quot;;
        }else{
            setTimeout(goIndexPage,1000);
            setTimeout(arguments.callee,1000); 更直接更好
        }
    }

alert(1);
setTimeout(&quot;alert(2)&quot;,0);
alert(3);
1 3 2; 单线程 阻塞式 插入队列,但不保证执行.

缓动动画:step = (target - leader)/10;
        step = step&gt;0 ? Math.ceil(step) : Math.floor(step);
        leader += step;
</code></pre>  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/事件/">事件</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/页面交互与事件处理/">页面交互与事件处理</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://yoursite.com/2016/12/02/页面交互与事件处理-Js事件相关/" data-title="事件相关 | 读书笔记" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2016/12/10/页面与布局-H5入门/" title="HTML5入门">
  <strong>新一篇:</strong><br/>
  <span>
  HTML5入门</span>
</a>
</div>


<div class="next">
<a href="/2016/12/02/JS面向对象-数组相关/"  title="数组方法汇总">
 <strong>旧一篇:</strong><br/> 
 <span>数组方法汇总
</span>
</a>
</div>

</nav>

	

</div>  
    </div>
    <footer><div id="footer" >
	<div class="copyright">
		<span>Powered by <a href="https://github.com/hexojs/hexo">Hexo</a> and theme by 
		<a href="https://github.com/levonlin/Tinnypp">Tinnypp</a>.</span>
		
			<span>© 高宽 Roy</span>
		
	<div>
</div></footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  //back to top
  function backToTop(){
    var buttonHTML = $("<a href=\"#top\" id=\"back-top\">" + "<span>Back to Top</span></a>");
    buttonHTML.appendTo($("body"));
    var buttonToTop = $("#back-top");
    // hide #back-top first
    buttonToTop.hide();

    // fade in #back-top
    $(function() {
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                buttonToTop.fadeIn();
            } else {
                buttonToTop.fadeOut();
            }
        });
        // scroll body to 0px on click
        buttonToTop.click(function() {
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });
    });
  }
  backToTop();

  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      ta = $('#toc.toc-aside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
        
    }
  });

  var show = true;
  c.click(function(){
    if(show == true){
        a.addClass('fadeOut').css('display', 'none');
        ta.css('display', 'block').addClass('fadeIn');
        m.addClass('moveMain');  
    }else{
        a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');     
        ta.css('display', 'none'); 
        m.removeClass('moveMain');
        $('#toc.toc-aside').css('display', 'none');
    }
    show = !show;
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{

    $(window).scroll(function(){
      ta.css("top",Math.max(140,240-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>

<script type="text/javascript">
  function footerPosition() {
    var contentHeight = document.documentElement.scrollHeight,
        winHeight = window.innerHeight;
    if(contentHeight <= winHeight) {
      $('footer').addClass('fixed-bottom');
    } else {
      $('footer').removeClass('fixed-bottom');
    }
  }
  footerPosition();
  $(window).resize(footerPosition);
</script>


  </body>
</html>
